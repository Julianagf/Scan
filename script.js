function updateHistory(a=0){var e=jQuery;if("undefined"!=typeof user_history_params){if(e(".wp-manga-chapter-img").length>0)var t=e(".wp-manga-chapter-img").prop("id").replace("image-","");else t="";e.ajax({url:user_history_params.ajax_url,type:"POST",data:{action:"manga-user-history",postID:user_history_params.postID,chapterSlug:user_history_params.chapter,paged:a||user_history_params.page,img_id:t,nonce:user_history_params.nonce}})}}function madara_update_views(){var a=jQuery;a("body").hasClass("single-wp-manga")&&"undefined"!=typeof manga&&"0"!=manga.enable_manga_view&&a.ajax({url:manga.ajax_url,type:"POST",data:{action:"manga_views",manga:manga.manga_id,chapter:manga.chapter_slug},success:function(a){},complete:function(a){}})}window.wpmanga={},window.wpmanga.setCookie=function(a,e,t){var n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3);var i="expires="+n.toUTCString();document.cookie=a+"="+e+";"+i+";path=/"},window.wpmanga.getCookie=function(a){for(var e=a+"=",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var i=t[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""},window.wpmanga.removeCookie=function(a){document.cookie=a+"=;  expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"},jQuery(document).ready((function(a){function e(){a("html, body").animate({scrollTop:a(".c-blog-post .reading-content").offset().top},500)}function t(){if(a(".chapter-selection").length>0){var e=a(".chapter-selection"),t={action:"manga_get_reading_nav",manga:a(e[0]).data("manga"),chapter:a(e[0]).data("chapter"),volume_id:a(e[0]).data("vol"),style:a(e[0]).data("style"),type:a(e[0]).data("type")};a.ajax({url:manga.ajax_url,type:"POST",data:t,success:function(e){a(".chapter-selection").each((function(){a(this).html(e)})),a(document).trigger("wp_manga_after_load_reading_nav")},complete:function(a){}})}else a(document).trigger("wp_manga_after_load_reading_nav")}function n(n){if(void 0===window.manga_navigating||!window.manga_navigating){if("undefined"==typeof mangaReadingAjax)return!1;var i=a(".read-container"),r=(a('.wp-manga-nav select#single-pager > option[selected="selected"]'),a(".nav-links .nav-previous"),a(".nav-links .nav-next"),a(".wp-manga-nav .entry-header_wrap").html()),c=a(".select-pagination");window.manga_navigating=!0,a.ajax({type:"GET",url:manga.ajax_url+"?"+n,beforeSend:function(){i.html('<i class="fas fa-spinner fa-spin"></i>'),c.hide(),a(".wp-manga-nav select").each((function(){a(this).prop("disabled",!0)}))},success:function(n){n.success?(i.html(n.data.data.content),a(".wp-manga-nav").replaceWith(n.data.data.nav),a(".entry-header .wp-manga-nav").prepend('<div class="entry-header_wrap">'+r+"</div>"),c.show(),o(),madara_update_views(),t(),a(".wp-manga-nav select").each((function(){a(this).prop("disabled",!1)})),void 0!==updateHistory&&updateHistory(a("#single-pager").val())):i.html(n.data.message),e(),a(document).trigger("wp_manga_chapterNavigationAjax_done")},complete:function(a,e){window.manga_navigating=!1}})}}function i(t){e(),t=parseInt(t);var n=a('#single-pager option[value="'+t+'"]'),i=a(".reading-content");if(n.length>0){a(".selectpicker_page select").each((function(){a("option",a(this)).removeAttr("selected"),a('option[value="'+t+'"]',a(this)).prop("selected",!0),a('option[value="'+t+'"]',a(this)).attr("selected","selected"),a(this).val(t)}));var o=t-1,r=t+1,c=a('#single-pager option[value="'+o+'"]'),s=a('#single-pager option[value="'+r+'"]'),l=a(".volume-select"),p=l.length>0,d=p?l.val():0;if(void 0===(A=a('.selectpicker_chapter[for="volume-id-'+d+'"] .single-chapter-select'))||void 0===A[0])return;selector=A.first();var g=selector.find(":selected").index()+1,m=p?l[0].selectedIndex+1:null,u=p?a(l[0]).data("order"):0;p&&(l=a(l[0]));var h=a(".nav-next a"),f=a(".nav-previous a"),v=h.data("order");h.show(),f.show();var _="",k="";if(c.length>0){if(_=c.data("redirect"),void 0!==(k=a(".nav-next a").data("navigation"))){var w=manga.manga_paged_var+"=(d+)",y=new RegExp(w,"g");k=k.replace(y,o)}}else{var x=v?g+1:g-1,b=p?u?m-1:m+1:null,j=p?a(".selectpicker_chapter:nth-child("+b+") .single-chapter-select").first():null;if(x<=0&&!v||v&&x>selector.find("option").length){if(null===b||p&&u&&b<=0||p&&!u&&b>l.find("option").length)f.hide();else _=(C=j.find("option:nth-child("+(v?2:j.find("option").length)+")")).data("redirect"),k=C.data("navigation")}else{var C;if(void 0===(A=a('.selectpicker_chapter[for="volume-id-'+d+'"] .single-chapter-select'))||void 0===A[0])return;selector=A.first(),_=(C=a(selector).find("option:nth-child("+x+")")).data("redirect"),k=C.data("navigation"),"undefined"!=typeof prevChapLastPage&&(_=_.replace("/p/1","/p/"+prevChapLastPage),k+="&"+manga.manga_paged_var+"="+prevChapLastPage)}}f.data("navigation",k),f.attr("href",_);var T="",D="",P=!1;if(s.length>0){if(T=s.data("redirect"),void 0!==(D=a(".nav-next a").data("navigation"))){w=manga.manga_paged_var+"=(d+)",y=new RegExp(w,"g");D=D.replace(y,r)}}else{var S=v?g-1:g+1;if(void 0===(A=a('.selectpicker_chapter[for="volume-id-'+d+'"] .single-chapter-select'))||void 0===A[0])return;if(selector=A.first(),g===a(selector).find("option").length&&!v||1==g&&v){var I=p?u?m+1:m-1:null;if(!p||m===l.find("option").length&&u||1===m&&!u)"on"==mangaNav.backInfoPage&&0==a(".btn-primary .back").length?(h.text(mangaNav.text.backInfoPage).removeClass("next_page").addClass("back"),T=mangaNav.mangaUrl,P=!0):h.hide();else{var O=a(".selectpicker_chapter:nth-child("+I+") .single-chapter-select").first();T=(N=O.find("option:nth-child("+(v?O.find("option").length:2)+")")).data("redirect"),D=N.data("navigation")}}else{var A,N;if(void 0===(A=a('.selectpicker_chapter[for="volume-id-'+d+'"] .single-chapter-select'))||void 0===A[0])return;selector=A.first(),T=(N=a(selector).find("option:nth-child("+S+")")).data("redirect"),D=N.data("navigation")}}h.data("navigation",D),h.attr("href",T),P||h.text(mangaNav.text.next).addClass("next_page").removeClass("back"),i.find("img").remove();for(var z=chapter_images_per_page*(t-1)+1,Q=a(".reading-content .page-prev-link").length,E="",U=1;U<=chapter_images_per_page&&void 0!==chapter_preloaded_images[z-1];U++)E+='<img id="image-'+z+'" data-image-paged="'+z+'" src="'+chapter_preloaded_images[z-1]+'" class="wp-manga-chapter-img">',z++;return Q?a(E).insertAfter(".reading-content .page-prev-link"):a(".reading-content").append(E),void 0!==updateHistory&&updateHistory(z),a(document).trigger("wp_manga_after_load_chapter_page",[t]),!0}return!1}function o(){a(".wp-manga-nav .nav-links > div > a.btn").each((function(){a(this).unbind("click"),a(this).on("click",(function(e){if(a(this).hasClass("back"))return!0;var t=a(this).data("navigation"),o=a(this).attr("href"),r=!1,c=!0;return"undefined"!=typeof chapter_preloaded_images&&(r=function(e=!0){var t=a("#single-pager").val();return e?t++:t--,i(t)}(!!a(this).hasClass("next_page")))&&(e.preventDefault(),c=!1),r||void 0===t||""===t||"undefined"==typeof mangaReadingAjax||(e.preventDefault(),a(document).trigger("wp_manga_on_chapter_navlinks_click"),n(t),c=!1),void 0!==o&&""!==o&&history.pushState({},null,o),!!c&&(window.location=o,!0)}))}))}a("#manga-chapters-holder").length>0?a.ajax({url:manga.base_url+"ajax/chapters/",type:"POST",success:function(e){a("#manga-chapters-holder").html(e),a(document).trigger("wp_manga_after_load_chapters_list")},complete:function(a){}}):setTimeout((function(){a(document).trigger("wp_manga_after_load_chapters_list")}),1e3),a(".btn-text-reading-increase").on("click",(function(e){var t=a(".reading-content .text-left").css("font-size"),n=parseInt(t.replace("px",""))+1;return a(".reading-content .text-left").css("font-size",n+"px"),a(".reading-content .text-left").css("line-height",1.5*n+"px"),window.wpmanga.setCookie("wpmanga-reading-fontsize",n,30),e.preventDefault(),e.stopPropagation(),!1})),a(".btn-text-reading-decrease").on("click",(function(e){var t=a(".reading-content .text-left").css("font-size"),n=parseInt(t.replace("px",""))-1;return a(".reading-content .text-left").css("font-size",(n<5?5:n)+"px"),a(".reading-content .text-left").css("line-height",(n<5?7.5:1.5*n)+"px"),window.wpmanga.setCookie("wpmanga-reading-fontsize",n,30),e.preventDefault(),e.stopPropagation(),!1})),a("#text-chapter-toolbar a").on("click",(function(e){return a(".entry-header.footer").toggleClass("sticky"),a("#text-chapter-toolbar").toggleClass("sticky"),e.preventDefault(),e.stopPropagation(),!1})),o(),a("body").hasClass("click-to-scroll")&&(a(".manga-reading-list-style .chapter-type-manga .reading-content").on("click",(function(e){"INPUT"!=e.target.nodeName&&a("html, body").animate({scrollTop:a(document).scrollTop()+500},200)})),a(".chapter-type-text .reading-content").on("click",(function(e){"INPUT"!=e.target.nodeName&&a("html, body").animate({scrollTop:a(document).scrollTop()+500},1e3)}))),a("body").hasClass("keyboard-navigate")&&a(document).keydown((function(e){document.activeElement&&"INPUT"==document.activeElement.tagName||"TEXTAREA"==document.activeElement.tagName||e.target.className.includes("ql-editor")||(37==e.keyCode&&a(".wp-manga-nav .nav-links .nav-previous > a").length>0?a(".wp-manga-nav .nav-links a.prev_page")[0].click():39==e.keyCode&&a(".wp-manga-nav .nav-links .nav-next > a").length>0&&a(".wp-manga-nav .nav-links a.next_page")[0].click())})),a(document).ready((function(){a("textarea#comment").attr("required","required"),a("#commentform").on("submit",(function(){return!!a("#commentform")[0].checkValidity()||(alert("Comment cannot be empty"),!1)})),t()})),a(document).on("wp_manga_after_load_reading_nav",(function(){a(document).on("change",".selectpicker.volume-select",(function(){a(".chapters_selectbox_holder .c-selectpicker.selectpicker_chapter").each((function(){a(this).hide()})),a('.chapters_selectbox_holder .c-selectpicker.selectpicker_chapter[for="volume-id-'+a(this).val()+'"]').show()})),a(document).on("change",".wp-manga-nav .single-chapter-select, #single-pager, .wp-manga-nav .host-select, .wp-manga-nav .reading-style-select",(function(e){e.preventDefault();var t="single-pager"==a(this).attr("id"),o=!!a(this).hasClass("single-chapter-select");if(t||o){var r=a(this).find("option:selected").data("navigation"),c=a(this).find("option:selected").data("redirect"),s=!1,l=!0;if(t&&"undefined"!=typeof chapter_preloaded_images&&(a(this).blur(),(s=i(a(this).val()))&&(l=!1)),s||"undefined"==typeof mangaReadingAjax||void 0===r||""===r||(n(r),l=!1),!l)return void 0!==c&&""!==c&&history.pushState({},null,c),!1}"#"!=(l=a(this).find(":selected").attr("data-redirect"))&&(window.location=l),a(document).trigger("wp_manga_chapter_redirect",[a(this),l,t,o])}))}));var r=!1;a(document).on("click",".wp-manga-action-button",(function(e){if(e.preventDefault(),"bookmark"==a(this).attr("data-action")){if("undefined"!=typeof requireLogin2BookMark)return a(".modal#form-login").modal("show"),void a('input[name="bookmarking"]').val("1");if(0!=a(".add-bookmark").length)a(".add-bookmark").css("opacity","0.5");else a('.action_list_icon a.wp-manga-action-button[data-action="bookmark"]').parent().css("opacity","0.5");if(!r){r=!0;var t=a(this),n=t.data("post"),i=a(".volume-select"),o=i.length>0?i.val():0,c=(a('.selectpicker_chapter[for="volume-id-'+o+'"] .single-chapter-select'),a("#wp-manga-current-chap").length>0?a("#wp-manga-current-chap").val():""),s=t.data("page");jQuery.ajax({url:manga.ajax_url,type:"POST",data:{action:"wp-manga-user-bookmark",postID:n,chapter:c,page:s},success:function(e){if(e.success)if(0!=a(".add-bookmark").length)a(".add-bookmark").empty(),a(".add-bookmark").append(e.data),a(".add-bookmark").css("opacity","1");else{var t=a('.action_list_icon a.wp-manga-action-button[data-action="bookmark"]').parent();t.empty(),t.append(e.data),t.css("opacity","1")}else e.data?"login_error"==e.data.code||alert(e.data.code):alert("Some errors occured. Please try again")},complete:function(a,e){r=!1}})}}else"toggle-contrast"==a(this).attr("data-action")&&(a("body").toggleClass("text-ui-light"),window.wpmanga.setCookie("wpmanga-reading-contrast",a("body").hasClass("text-ui-light")?"light":"dark",30),"undefined"!=typeof DISQUS&&DISQUS.reset({reload:!0,config:disqus_config}))}));var c=!1;a(document).on("click",".wp-manga-delete-bookmark",(function(e){if(e.preventDefault(),!c){c=!0;var t=a(this).data("post-id"),n=a(this).closest("tr");if(0!=n.length){n.css("opacity","0.5");var i=0}if(0!=a(".add-bookmark .action_icon .wp-manga-delete-bookmark").length){i=1;a(".add-bookmark").css("opacity","0.5")}else{i=0;a('.action_list_icon a.wp-manga-action-button[data-action="bookmark"]').parent().css("opacity","0.5")}jQuery.ajax({url:manga.ajax_url,type:"POST",data:{action:"wp-manga-delete-bookmark",postID:t,isMangaSingle:i},success:function(e){if(e.success)if(0!=n.length&&(n.fadeOut(),n.remove()),void 0!==i&&1==i)a(".add-bookmark").empty(),a(".add-bookmark").append(e.data),a(".add-bookmark").css("opacity","1");else if(void 0!==i&&0==i)if(1==e.data.is_empty)alert(e.data.msg);else{var t=a(".action_list_icon a.wp-manga-delete-bookmark").parent();t.empty(),t.append(e.data),t.css("opacity","1")}},complete:function(a,e){c=!1}})}}));c=!1;a(document).on("click","#delete-bookmark-manga",(function(e){if(e.preventDefault(),!c){c=!0;var t=[];a(".bookmark-checkbox:checkbox:checked").each((function(e){t[e]=a(this).val(),a(this).closest("tr").addClass("remove"),a(this).closest("tr").css("opacity","0.5")})),jQuery.ajax({url:manga.ajax_url,type:"POST",data:{action:"wp-manga-delete-multi-bookmark",bookmark:t},success:function(e){e.success&&a("tr.remove").remove()},complete:function(a,e){c=!1}})}})),a(document).on("change","#wp-manga-bookmark-checkall",(function(e){e.preventDefault();var t=a(this),n=a(".bookmark-checkbox");n.length>0&&(t.is(":checked")?a.each(n,(function(e,t){a(t).prop("checked",!0)})):a.each(n,(function(e,t){a(t).prop("checked",!1)})))})),a("form.manga-search-form.ajax input.manga-search-field").each((function(){a(this).parent().children(".ion-ios-search-strong");var e=a(this).parent();a(this).autocomplete({appendTo:e,source:function(e,t){a.ajax({url:manga.ajax_url,type:"POST",dataType:"json",data:{action:"wp-manga-search-manga",title:e.term},success:function(e){t(a.map(e.data,(function(a){return 1==e.success?{label:a.title,value:a.title,url:a.url,type:a.type}:{label:a.message,value:a.message,type:a.type,click:!1}})))}})},select:function(a,e){if(!e.item.url)return!!e.item.click;window.location.href=e.item.url},open:function(e,t){var n=a(this).data("uiAutocomplete");n.menu.element.addClass("manga-autocomplete").find("li div").each((function(){var e=a(this),t=a.trim(n.term).split(" ").join("|");e.html(e.text().replace(new RegExp("("+t+")","gi"),'<span class="manga-text-highlight">$1</span>'))}))},change:function(a,e){return!1}}).autocomplete("instance")._renderItem=function(e,t){return a("<li class='search-item'>").append("<div class='manga-type-"+t.type+"'>"+t.label+"</div>").appendTo(e)}})),a('input[name="wp-manga-user-avatar"]').on("change",(function(e){this.files.length?a(".file-name").html(this.files[0].name):a(".file-name").html("")})),a(document).on("click","#wp-manga-upload-avatar",(function(e){e.preventDefault();var t=a(this),n=a(".choose-avatar"),i=a(".c-user-avatar"),o=new FormData,r=a('input[name="wp-manga-user-avatar"]')[0].files[0],c=a('input[name="userID"]').val(),s=a('input[name="_wpnonce"]').val();o.append("action","wp-manga-upload-avatar"),o.append("userAvatar",r),o.append("userID",c),o.append("_wpnonce",s),jQuery.ajax({url:manga.ajax_url,type:"POST",enctype:"multipart/form-data",cache:!1,contentType:!1,processData:!1,data:o,beforeSend:function(){t.attr("disabled","disabled"),n.addClass("uploading")},success:function(a){a.success?(i.empty(),i.append(a.data)):alert(a.data.msg)},complete:function(a,e){t.removeAttr("disabled"),n.removeClass("uploading")}})})),a(document).on("click",".remove-manga-history",(function(e){e.preventDefault();var t=a(this).data("manga"),n=a(this).closest(".col-md-4");n.css("opacity","0.5"),a.ajax({url:manga.ajax_url,type:"POST",data:{action:"manga-remove-history",postID:t},success:function(e){e.success?(n.fadeOut(),n.remove(),1==e.data.is_empty&&(a(".tab-pane#history").empty(),a(".tab-pane#history").append(e.data.msg))):n.css("opacity","1")}})}));var s=!1;if(a(document).on("click",".wp-manga-ajax-button",(function(e){if(e.preventDefault(),0==s){s=!0;var t=a(this),n=(e=a(this).data("element"),a(this).data("template")),i=a(this).parent();t.addClass("loading"),a.ajax({url:manga.ajax_url,type:"POST",data:{action:"wp_manga_archive_loadmore",manga_args:manga_args,template:n},success:function(n){t.removeClass("loading"),a(".wp-manga-query-vars").remove(),a(e).append(n),manga_args.paged>=manga_args.max_num_pages&&i.remove()}})}})),a(".page-item-detail.video").each((function(){a(".item-thumb a",a(this)).on("click",(function(e){var t=a(this).closest(".page-item-detail");if($latest_chapter=a(".list-chapter .chapter-item",t)[0],$latest_chapter){var n=a(a(".chapter a",t)[0]).attr("href");return location.href=n,e.stopPropagation(),!1}}))})),a("body").hasClass("reading-manga")){var l=window.wpmanga.getCookie("wpmanga-reading-contrast");""!=l&&("light"==l?(a("body").addClass("text-ui-light"),a("body").removeClass("text-ui-dark")):(a("body").removeClass("text-ui-light"),a("body").addClass("text-ui-dark")));var p=window.wpmanga.getCookie("wpmanga-reading-fontsize");a(".c-page-content.chapter-type-text").length>0&&p&&(a(".reading-content .text-left").css("font-size",p+"px"),a(".reading-content .text-left").css("line-height",1.5*p+"px"))}madara_update_views()})),"undefined"!=typeof wpdiscuzAjaxObj&&(wpdiscuzAjaxObj.wp_manga_chapter_comment=function(a,e,t){return a.append("chapterId",jQuery("input[name=chapter_id]").val()),a});